<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Hangul Typing</title>
    <link rel="stylesheet" href="korean-fonts.css">
    <link rel="stylesheet" href="style.css">
    <link rel="icon" href="favicon.svg" type="image/svg+xml">
</head>
<body>
    <div id="loading" class="loading">
        <p>Loading...</p>
    </div>

    <div class="container" id="app" style="display: none;">
        <header>
            <h1>Hangul Typing <span class="version-tag" id="version-tag"></span></h1>
            <p class="tagline">Learn Korean typing by playing. Break levels. Master Hangul.</p>
        </header>

        <main>
            <!-- Level Selection -->
            <section id="level-select" class="screen active">
                <h2>Select Level</h2>
                <div class="levels">
                    <button class="level-btn" data-level="1">
                        <span class="level-num">1</span>
                        <span class="level-name">Basic Vowels</span>
                        <span class="level-chars">ㅏ ㅓ ㅗ ㅜ ㅡ ㅣ</span>
                    </button>
                    <button class="level-btn locked" data-level="2">
                        <span class="level-num">2</span>
                        <span class="level-name">Basic Consonants</span>
                        <span class="level-chars">ㄱ ㄴ ㄷ ㄹ ㅁ ㅂ ㅅ ㅇ ㅈ</span>
                    </button>
                    <button class="level-btn locked" data-level="3">
                        <span class="level-num">3</span>
                        <span class="level-name">Simple Syllables</span>
                        <span class="level-chars">가 나 다 마</span>
                    </button>
                    <button class="level-btn locked" data-level="4">
                        <span class="level-num">4</span>
                        <span class="level-name">Final Consonants</span>
                        <span class="level-chars">간 날 달 말</span>
                    </button>
                    <button class="level-btn locked" data-level="5">
                        <span class="level-num">5</span>
                        <span class="level-name">Double Consonants</span>
                        <span class="level-chars">ㄲ ㄸ ㅃ ㅆ ㅉ</span>
                    </button>
                    <button class="level-btn locked" data-level="6">
                        <span class="level-num">6</span>
                        <span class="level-name">Complex Vowels</span>
                        <span class="level-chars">ㅐ ㅔ ㅚ ㅟ ㅢ</span>
                    </button>
                    <button class="level-btn locked" data-level="7">
                        <span class="level-num">7</span>
                        <span class="level-name">Common Words</span>
                        <span class="level-chars">한국 사람 감사</span>
                    </button>
                    <button class="level-btn locked" data-level="8">
                        <span class="level-num">8</span>
                        <span class="level-name">Short Phrases</span>
                        <span class="level-chars">안녕하세요</span>
                    </button>
                    <button class="level-btn locked" data-level="9">
                        <span class="level-num">9</span>
                        <span class="level-name">Full Sentences</span>
                        <span class="level-chars">오늘 날씨가 좋아요</span>
                    </button>
                </div>
            </section>

            <!-- Game Screen -->
            <section id="game" class="screen">
                <div class="game-header">
                    <button id="back-btn" class="icon-btn" title="Back to levels">
                        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M19 12H5M12 19l-7-7 7-7"/>
                        </svg>
                    </button>
                    <div class="game-info">
                        <span id="level-display">Level 1</span>
                        <span id="score-display">Score: 0</span>
                        <span id="accuracy-display">100%</span>
                    </div>
                </div>

                <div class="game-area">
                    <div id="target" class="target">ㅏ</div>
                    <div id="input-display" class="input-display"></div>
                    <div id="feedback" class="feedback"></div>
                </div>

                <!-- 2-Bulsik Keyboard Visualization -->
                <div id="keyboard" class="keyboard">
                    <div class="keyboard-row">
                        <div class="key" data-key="q"><span class="hangul">ㅂ</span><span class="shift">ㅃ</span></div>
                        <div class="key" data-key="w"><span class="hangul">ㅈ</span><span class="shift">ㅉ</span></div>
                        <div class="key" data-key="e"><span class="hangul">ㄷ</span><span class="shift">ㄸ</span></div>
                        <div class="key" data-key="r"><span class="hangul">ㄱ</span><span class="shift">ㄲ</span></div>
                        <div class="key" data-key="t"><span class="hangul">ㅅ</span><span class="shift">ㅆ</span></div>
                        <div class="key" data-key="y"><span class="hangul">ㅛ</span></div>
                        <div class="key" data-key="u"><span class="hangul">ㅕ</span></div>
                        <div class="key" data-key="i"><span class="hangul">ㅑ</span></div>
                        <div class="key" data-key="o"><span class="hangul">ㅐ</span><span class="shift">ㅒ</span></div>
                        <div class="key" data-key="p"><span class="hangul">ㅔ</span><span class="shift">ㅖ</span></div>
                    </div>
                    <div class="keyboard-row">
                        <div class="key" data-key="a"><span class="hangul">ㅁ</span></div>
                        <div class="key" data-key="s"><span class="hangul">ㄴ</span></div>
                        <div class="key" data-key="d"><span class="hangul">ㅇ</span></div>
                        <div class="key" data-key="f"><span class="hangul">ㄹ</span></div>
                        <div class="key" data-key="g"><span class="hangul">ㅎ</span></div>
                        <div class="key" data-key="h"><span class="hangul">ㅗ</span></div>
                        <div class="key" data-key="j"><span class="hangul">ㅓ</span></div>
                        <div class="key" data-key="k"><span class="hangul">ㅏ</span></div>
                        <div class="key" data-key="l"><span class="hangul">ㅣ</span></div>
                    </div>
                    <div class="keyboard-row">
                        <div class="key shift-key" data-key="shift"><span class="label">Shift</span></div>
                        <div class="key" data-key="z"><span class="hangul">ㅋ</span></div>
                        <div class="key" data-key="x"><span class="hangul">ㅌ</span></div>
                        <div class="key" data-key="c"><span class="hangul">ㅊ</span></div>
                        <div class="key" data-key="v"><span class="hangul">ㅍ</span></div>
                        <div class="key" data-key="b"><span class="hangul">ㅠ</span></div>
                        <div class="key" data-key="n"><span class="hangul">ㅜ</span></div>
                        <div class="key" data-key="m"><span class="hangul">ㅡ</span></div>
                    </div>
                </div>

                <div class="progress-bar">
                    <div id="progress" class="progress"></div>
                </div>
            </section>

            <!-- Result Screen -->
            <section id="result" class="screen">
                <div class="result-content">
                    <h2 id="result-title">Level Complete!</h2>
                    <div class="stars" id="stars">
                        <span class="star">★</span>
                        <span class="star">★</span>
                        <span class="star">★</span>
                    </div>
                    <div class="result-stats">
                        <p>Accuracy: <span id="final-accuracy">100%</span></p>
                        <p>Score: <span id="final-score">0</span></p>
                    </div>
                    <div class="result-actions">
                        <button id="retry-btn" class="btn">Try Again</button>
                        <button id="next-btn" class="btn primary">Next Level</button>
                    </div>
                </div>
            </section>
        </main>

        <footer>
            <p>Powered by <a href="https://github.com/pastel-sketchbook/hangul-wasm">hangul.wasm</a></p>
            <p class="ime-status" id="ime-status"></p>
        </footer>
    </div>

    <!-- AI Assistant Panel (Copilot) -->
    <aside id="assistant-panel" class="assistant-panel hidden">
        <div class="assistant-header">
            <h3>
                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <circle cx="12" cy="12" r="10"/>
                    <path d="M12 16v-4M12 8h.01"/>
                </svg>
                AI Assistant
            </h3>
            <button id="assistant-close" class="icon-btn" title="Close assistant">
                <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M18 6L6 18M6 6l12 12"/>
                </svg>
            </button>
        </div>
        <div class="assistant-messages" id="assistant-messages">
            <div class="assistant-welcome">
                <p>Hi! I'm your Korean typing tutor. Ask me anything about Hangul!</p>
                <div class="quick-actions">
                    <button class="quick-action" data-action="explain-target">Explain current character</button>
                    <button class="quick-action" data-action="get-hint">Give me a hint</button>
                    <button class="quick-action" data-action="how-to-type">How do I type this?</button>
                </div>
            </div>
        </div>
        <div class="assistant-input-area">
            <input type="text" id="assistant-input" placeholder="Ask about Korean typing..." autocomplete="off">
            <button id="assistant-send" class="icon-btn" title="Send">
                <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M22 2L11 13M22 2l-7 20-4-9-9-4 20-7z"/>
                </svg>
            </button>
        </div>
        <div class="assistant-status" id="assistant-status"></div>
    </aside>

    <!-- Assistant Toggle Button -->
    <button id="assistant-toggle" class="assistant-toggle hidden" title="AI Assistant (?)">
        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <circle cx="12" cy="12" r="10"/>
            <path d="M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3M12 17h.01"/>
        </svg>
    </button>

    <script type="module" src="dist/app.js"></script>
</body>
</html>
